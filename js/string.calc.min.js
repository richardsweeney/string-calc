$(document).bind("mobileinit",function(){$.extend($.mobile,{touchOverflowEnabled:true,defaultPageTransition:"slide"})});$(document).bind("pagecreate",function(){$list=$(".iOSlist-container ul");if($list.length){$.each($list,function(){var a=$(this).find("li");if(a.length===1){a.addClass("single-list-item")}})}});$(function(){Vals={create:function(H){var G=function(){};G.prototype=H;return new G()},oct:[0.0625,0.125,0.25,0.5,1,2,4,8,16,32,64],semiTone:1.059463,metricImperial:"",mmToInch:0.0393700787,kgToLbs:0.45359237,customCalc:{note:9,octave:4},resultsList:[],calcHelper:{},customTunings:{tempTuning:{name:"",stringLength:"",tuning:[]},editing:false,tempTuningArray:[],customTuning:{},customTuningsObject:{},tuningsArray:[],editTuningId:""},instruments:{lists:{},current:{},quickie:{stringLength:60,material:"gut",pitch:440,density:1300,dataName:"quickie",name:"Quick Calculation"},custom:{},bowed:[{dataName:"violin",name:"Violin",stringLength:33,multipleTunings:false,tuning:[[5,5],[0,4],[7,4],[2,3]]},{dataName:"viola",name:"Viola",stringLength:36,multipleTunings:false,tuning:[[0,4],[7,4],[2,3],[9,3]]},{dataName:"cello",name:"Cello",stringLength:68,multipleTunings:false,tuning:[[0,3],[7,3],[2,2],[9,2]]},{dataName:"doubleBass",name:"Double Bass",stringLength:105,multipleTuings:false,tuning:[[2,2],[7,2],[0,1],[5,1]]},{dataName:"violinoPiccolo",name:"Violino Piccolo",stringLength:30,multipleTunings:false,tuning:[[2,5],[9,5],[4,4],[-1,3]]},{dataName:"violoncelloPiccolo",name:"Violoncello Piccolo/da Spalla",stringLength:65,multipleTunings:false,tuning:[[5,4],[0,3],[7,3],[2,2],[9,2]]},{dataName:"bassViolin",name:"Bass Violin",stringLength:75,multipleTunings:false,tuning:[[2,3],[9,3],[4,2],[-1,1]]},{dataName:"violaDamore",name:"Viola d'Amore",stringLength:40,multipleTunings:true,tuningId:0,tuning:[{name:"D major",tuning:[[7,5],[0,4],[3,4],[7,4],[0,3],[7,3],[0,2]]},{name:"D minor",tuning:[[7,5],[0,4],[4,4],[7,4],[0,3],[7,3],[0,2]]}]},{dataName:"violaDaGamba",name:"Viola da Gamba",stringLength:69,multipleTunings:true,tuningId:2,tuning:[{name:"D (contrabasso)",tuning:[[7,3],[0,2],[5,2],[9,2],[2,1],[7,1]]},{name:"G (violone)",tuning:[[2,3],[7,3],[0,2],[4,2],[9,2],[2,1]]},{name:"D (bass)",tuning:[[7,4],[0,3],[5,3],[9,3],[2,2],[7,2]]},{name:"G (tenor)",tuning:[[2,4],[7,4],[0,3],[4,3],[9,3],[2,2]]},{name:"A (alto)",tuning:[[0,4],[5,4],[-2,3],[2,3],[7,3],[0,2]]},{name:"D (treble)",tuning:[[7,3],[0,4],[5,4],[9,4],[2,3],[7,3]]},{name:"7 string in D",tuning:[[7,4],[0,3],[5,3],[9,3],[2,2],[7,2],[0,1]]}]}],plucked:[{dataName:"renaissanceLute",name:"Renaissance Lute",material:"gut",pitch:415,density:1300,stringLength:60,numberCourses:10,octavesFromCourse:6,showOctaves:true,multipleTunings:true,tuningId:4,tuning:[{name:"C (low bass)",tuning:[[9,4],[2,3],[7,3],[-1,2],[4,2],[9,2],[-1,1],[0,1],[2,1],[4,1],[5,1],[7,1]]},{name:"D (bass)",tuning:[[7,4],[0,3],[5,3],[9,3],[2,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[4,1],[5,1]]},{name:"E",tuning:[[5,4],[-2,3],[3,3],[7,3],[0,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[3,1]]},{name:"F",tuning:[[4,4],[9,4],[2,3],[6,3],[-1,2],[4,2],[5,2],[7,2],[9,2],[-1,1],[0,1],[2,1]]},{name:"G (tenor)",tuning:[[2,4],[7,4],[0,3],[4,3],[9,3],[2,2],[4,2],[5,2],[7,2],[9,2],[0,1],[-2,1]]},{name:"A (alto)",tuning:[[0,4],[5,4],[-2,3],[2,3],[7,3],[0,2],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1]]},{name:"D (treble)",tuning:[[7,3],[0,4],[5,4],[9,4],[2,3],[7,3],[9,3],[-2,2],[0,2],[2,2],[4,2],[5,2]]},{name:"G (octave lute)",tuning:[[2,5],[7,5],[0,4],[4,4],[9,4],[2,3],[4,3],[5,3],[7,3],[9,3],[0,1],[-2,1]]}]},{dataName:"baroqueLute",name:"Baroque Lute",material:"gut",pitch:415,density:1300,stringLength:71,diapasonLength:96,numberCourses:13,frettedCourses:8,octavesFromCourse:6,showOctaves:true,multipleTunings:false,tuning:[[4,4],[7,4],[0,3],[4,3],[7,3],[0,2],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1]]},{dataName:"archlute",name:"Archlute",material:"gut",pitch:415,density:1300,stringLength:67,diapasonLength:150,numberCourses:14,frettedCourses:6,octavesFromCourse:5,singleDiapasons:true,showOctaves:true,multipleTunings:false,tuning:[[2,4],[7,4],[0,3],[4,3],[9,3],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[4,1]]},{dataName:"theorbo",name:"Theorbo",material:"gut",pitch:415,density:1300,stringLength:90,diapasonLength:160,numberCourses:14,frettedCourses:6,octavesFromCourse:5,singleDiapasons:true,showOctaves:false,multipleTunings:true,tuningId:0,tuning:[{name:"A: re-entrant 1 + 2",tuning:[[0,3],[5,3],[-2,3],[2,3],[7,3],[0,2],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1]]},{name:"A: re-entrant 1",tuning:[[0,3],[5,4],[-2,3],[2,3],[7,3],[0,2],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1]]},{name:"G: re-entrant 1 + 2",tuning:[[2,3],[7,3],[0,3],[4,3],[9,3],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[4,1]]},{name:"G: re-entrant 1",tuning:[[2,3],[7,4],[0,3],[4,3],[9,3],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[4,1]]},{name:"D minor",tuning:[[7,4],[0,3],[4,3],[7,3],[0,2],[2,2],[4,2],[5,2],[7,2],[9,2],[-2,1],[0,1],[2,1],[4,1]]}]},{dataName:"baroqueGuitar",name:"Baroque Guitar",material:"gut",pitch:415,density:1300,stringLength:66,numberCourses:5,octavesFromCourse:4,showOctaves:true,multipleTunings:false,tuning:[[5,4],[-2,3],[2,3],[7,4],[0,2]]},{dataName:"mandolin",name:"Mandolin",material:"steel",pitch:440,density:7800,stringLength:33,multipleTunings:false,tuning:[[5,5],[0,4],[7,4],[2,3]]},{dataName:"ukulele",name:"Ukulele",material:"nylon",pitch:440,density:1140,stringLength:33,multipleTunings:true,tuningId:0,tuning:[{name:"D tuning, re-entrant",tuning:[[-2,4],[3,4],[7,4],[0,4]]},{name:"D tuning, low 4th",tuning:[[-2,4],[3,4],[7,4],[0,3]]},{name:"C tuning, re-entrant",tuning:[[0,4],[5,4],[9,4],[2,4]]},{name:"C tuning, low 4th",tuning:[[0,4],[5,4],[9,4],[2,3]]},{name:"G tuning, re-entrant",tuning:[[5,4],[-2,3],[2,3],[7,4]]},{name:"G tuning, low 4th",tuning:[[5,4],[-2,3],[2,3],[7,3]]}]},{dataName:"oud",name:"Oud",material:"gut",pitch:440,density:1300,stringLength:63,octavesFromCourse:5,showOctaves:true,multipleTunings:true,tuningId:0,tuning:[{name:"C, G, D, A, E, C",tuning:[[9,4],[2,3],[7,3],[0,2],[5,2],[9,2]]},{name:"C, G, D, A, F, C",tuning:[[9,4],[2,3],[7,3],[0,2],[4,2],[9,2]]},{name:"C, G, D, A, G, D",tuning:[[9,4],[2,3],[7,3],[0,2],[2,2],[7,2]]},{name:"C, G, D, A, F, D",tuning:[[9,4],[2,3],[7,3],[0,2],[4,2],[7,2]]},{name:"D, A, E, B, G, D",tuning:[[7,4],[0,3],[5,3],[-2,2],[2,2],[7,2]]},{name:"D, A, E, B, F#, D",tuning:[[7,4],[0,3],[5,3],[-2,2],[3,2],[7,2]]},{name:"D, A, E, B, F#, C#",tuning:[[7,4],[0,3],[5,3],[-2,2],[3,2],[8,2]]},{name:"D, A, E, B, F#, B",tuning:[[7,4],[0,3],[5,3],[-2,2],[3,2],[-2,1]]}]}]},materials:[{name:"Nylon",dataName:"nylon",density:1140},{name:"Nylgut",dataName:"nylgut",density:1260},{name:"Gut / Silk",dataName:"gut",density:1300},{name:"New Nylgut",dataName:"newNylgut",density:1300},{name:"Carbon",dataName:"carbon",density:1790},{name:"Steel",dataName:"steel",density:7800},{name:"Iron",dataName:"iron",density:7870},{name:"Bronze",dataName:"bronze",density:8600},{name:"Copper",dataName:"copper",density:8900}],pitches:[392,415,430,440,466],longLutes:["archlute","baroqueLute","theorbo"],listInstruments:function(J){var I=r.instruments[J],H='<ul id="instrumentList" data-role="listview" data-inset="true">';for(var G=0,F=I.length;G<F;G++){H+='<li><a class="choose-instrument" href="#options" data-id="'+G+'" data-instrument="'+I[G].dataName+'">'+I[G].name+"</a></li>"}H+="</ul>";return H},customTone:{accidental:"natural",note:"C",octave:4,pitchOffset:9},calculations:function(K,H,F,J){var G;switch(H){case 9:G="C";break;case 8:G="C#";break;case 7:G="D";break;case 6:G="Eb";break;case 5:G="E";break;case 4:G="F";break;case 3:G="F#";break;case 2:G="G";break;case 1:G="G#";break;case 0:G="A";break;case -1:G="Bb";break;case -2:G="B";break;default:0}var I='<div data-role="collapsible" class="daddy" data-collapsed="true" data-pitchOffset="'+H+'" data-octave="'+F+'"><h3 class="calculations">'+K+" - "+G+F+'</h3><label class="dab" for="diameter">Enter the diameter or tension</label><input class="diameterOrTension" type="number" data-key="diameterOrTension" id="diameter" /><fieldset class="ui-grid-a"><div class="ui-block-a"><button class="trigger calculateDiameter';if(J===true){I+=" diapason"}I+='" type="submit">Calculate Diameter</button></div><div class="ui-block-b"><button class="trigger calculateTension';if(J===true){I+=" diapason"}I+='" type="submit">Calculate Tension</button></div></fieldset><p class="resultat off"></p></div>';return I},capitalizeFirstLetter:function(F){return F.charAt(0).toUpperCase()+F.slice(1)},whichTone:function(G){var F;switch(G){case"C":F=9;break;case"D":F=7;break;case"E":F=5;break;case"F":F=4;break;case"G":F=2;break;case"A":F=0;break;case"B":case"H":F=-2;break}return F},whichNote:function(G){var F="";switch(G){case 9:F="C";break;case 8:F="C#";break;case 7:F="D";break;case 6:F="Eb";break;case 5:F="E";break;case 4:F="F";break;case 3:F="F#";break;case 2:F="G";break;case 1:F="G#";break;case 0:F="A";break;case -1:F="Bb";break;case -2:F="B";break;default:0}return F},options:function(){var J=this.instruments.current,H=(localStorage.metricImperial==="metric")?+J.stringLength:Math.round((+J.stringLength*this.mmToInch)*100)/10,M=J.material;if(J.material==="newNylgut"){M="New Nylgut"}else{if(J.material==="gut"){M="Gut / Silk"}else{M=this.capitalizeFirstLetter(J.material)}}var L='<ul id="optionsList" data-role="false"><li><a data-transition="flip" href="#pitch"><span>Pitch:</span> '+J.pitch+' Hz</a></li><li><a data-transition="flip" href="#material"><span>String material:</span> '+M+"</a></li>";if(J.diapasonLength!==undefined){var K=(localStorage.metricImperial==="metric")?+J.diapasonLength:Math.round((+J.diapasonLength*r.mmToInch)*100)/10;L+='<li><a data-transition="flip" href="#string-length"><span>String lengths:</span> '+H+" / "+K+" "+this.unitLength+"</a></li>"}else{L+='<li><a data-transition="flip" href="#string-length"><span>String length:</span> '+H+" "+this.unitLength+"</a></li>"}if(J.numberCourses!==undefined){L+='<li><a data-transition="flip" href="#number-courses"><span>Number of courses:</span> '+J.numberCourses+"</a></li>"}if(J.diapasonLength!==undefined){var G=J.frettedCourses;L+='<li><a data-transition="flip" href="#number-fretted-courses"><span>Fretted courses:</span> '+G+"</a></li>"}if(J.multipleTunings===true){var I=+J.tuningId,F=J.tuning[I].name;L+='<li><a data-transition="flip" href="#dynamic-tuning"><span>Tuning:</span> '+F+"</a></li>"}if(J.showOctaves!==undefined){if(J.showOctaves===true){L+='<li><a data-transition="flip" href="#octave-courses"><span>Show octaves from course:</span> '+ +J.octavesFromCourse+"</a></li>"}else{if(J.showOctaves===false){L+='<li><a data-transition="flip" href="#octave-courses"><span>Show octave courses:</span> no</a></li>'}}}if(J.singleDiapasons!==undefined){var N=(J.singleDiapasons===true)?"yes":"doubles";L+='<li><a data-transition="flip" href="#single-diapasons-page"><span>Single diapasons:</span> '+N+"</a></li>"}L+="</ul>";return L},showSavedMessage:function(F){var G=$('<span class="saved-message">Saved!</span>').insertBefore(F);setTimeout(function(){G.addClass("woot");setTimeout(function(){G.addClass("skoot");setTimeout(function(){G.remove()},250)},1500)},10)}};var r=Vals.create(Vals);(function p(){r.isLocalStorage=(function(){var G=new Date,F;try{localStorage.setItem(G,G);F=localStorage.getItem(G)==G;localStorage.removeItem(G);return F}catch(H){}})();if(r.isLocalStorage===true){r.customTunings.tuningsArray=(localStorage.customTunings!==undefined)?JSON.parse(localStorage.customTunings):[];r.customDefaults=(localStorage.customDefaults!==undefined)?JSON.parse(localStorage.customDefaults):[];r.resultsList=(localStorage.resultsList!==undefined)?JSON.parse(localStorage.resultsList):[];r.instruments.lists.bowed=r.listInstruments("bowed");r.instruments.lists.plucked=r.listInstruments("plucked");if($.isEmptyObject(r.instruments.current)){if(localStorage.current!==undefined){r.instruments.current=JSON.parse(localStorage.current)}}}else{alert("Local storage is not available on your device. You won't be able to save results and/or preferences. Go get yourself an iPhone and all your problems will be solved :)")}switch(localStorage.metricImperial){case undefined:localStorage.metricImperial="metric";r.metricImperial="metric";r.unitDiameter="mm";r.unitDensity="kg";r.unitLength="cm";break;case"metric":r.metricImperial="metric";r.unitDiameter="mm";r.unitDensity="kg";r.unitLength="cm";break;case"imperial":r.metricImperial="imperial";r.unitDiameter="in";r.unitDensity="lbs";r.unitLength="in";break}})();r.addMaterialsToPage=function(H,G,F){var I='<label for="'+F+'">'+H+" ("+G+" kg/m&sup3;)</label>";if(this.instruments.current.material===F){I+='<input class="density" id="'+F+'" name="density" data-key="density" type="radio" value="'+G+'" checked="checked" />'}else{I+='<input class="density" id="'+F+'" name="density" data-key="density" type="radio" value="'+G+'" />'}return I};r.addPitchesToPage=function(G){var F='<label for="pitch-'+G+'">'+G+" Hz</label>";if(this.instruments.current.pitch==G){F+='<input class="pitch" type="radio" name="pitch" data-key="pitch" id="pitch-'+G+'" value="'+G+'" checked="checked" />'}else{F+='<input class="pitch" type="radio" name="pitch" data-key="pitch" id="pitch-'+G+'" value="'+G+'" />'}return F};r.addTuningsToPage=function(){var L=this.instruments.current.tuning,I=+this.instruments.current.tuningId,G='<fieldset id="fieldContainer" class="quickChange" data-role="controlgroup">';for(var J=0,H=L.length;J<H;J++){var F=L[J].name,K=L[J].dataName;G+=(J===I)?'<input class="tuning" id="'+J+'" type="radio" name="tuning" value="'+K+'" checked="checked" /><label for="'+J+'">'+F+"</label>":'<input class="tuning" id="'+J+'" type="radio" name="tuning" value="'+K+'" /><label for="'+J+'">'+F+"</label>"}G+="</fieldset>";return G};r.addCalcsToPage=function(){var L=this.instruments.current,M=(L.multipleTunings===true)?L.tuning[+L.tuningId].tuning:L.tuning,F=M.slice(0,L.numberCourses),K='<select name="select-string" id="select-string">';if(L.frettedCourses!==undefined){var N=L.frettedCourses,F=F.slice(0,N),J=(L.multipleTunings===true)?L.tuning[+L.tuningId].tuning:L.tuning,G=J.slice(N,L.numberCourses);K+='<optgroup label="Fretted Strings">';for(var I=0,H=F.length;I<H;I++){K+='<option value="'+I+'">'+(I+1)+": "+this.whichNote(F[I][0])+F[I][1]+"</option>"}K+='</optgroup><optgroup label="Diapasons">';for(var I=0,H=G.length;I<H;I++){K+='<option value="'+(+L.frettedCourses+I)+'">'+((+L.frettedCourses+I)+1)+": "+this.whichNote(G[I][0])+G[I][1]+"</option>"}K+="</optgroup>"}else{for(var I=0,H=F.length;I<H;I++){K+='<option value="'+I+'">'+(I+1)+": "+this.whichNote(F[I][0])+F[I][1]+"</option>"}}K+="</select>";return K};r.calculateFrequency=function(F,G){return(r.instruments.current.pitch/Math.pow(this.semiTone,F))*G};r.createDiameterTensionSelectLists=function(J,G){for(var H=0,F=J.length;H<F;H++){var I=function(){var L=J[H][1],M='<select class="'+G+'" data-iconpos="none" id="'+J[H][2]+'">';for(var K=0;K<L;K++){M+='<option value="'+K+'">'+K+"</option>"}M+="</select>";return M};$("#"+J[H][0]).append(I).trigger("create")}};r.createNoteSelectList=function(K){var I='<div data-role="fieldcontain" class="rps"><select data-iconpos="none" class="custom-tone-select" name="select-string" id="'+K+'">',J=["C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B"];for(var H=0,G=9,F=J.length;H<F;H++,G--){I+='<option value="'+G+'">'+J[H]+"</option>"}I+="</select></div>";return I};r.createOctaveSelectList=function(J){var I='<div data-role="fieldcontain" class="rps"><select data-iconpos="none" class="custom-tone-select" name="select-string" id="'+J+'">',G=[0,1,2,3,4,5,6,7,8,9];for(var H=0,F=G.length;H<F;H++){I+='<option value="'+G[H]+'">'+G[H]+"</option>"}I+="</select></div>";return I};r.doCalcs=function(){var G=this.instruments.current,F=(this.calcHelper.diapason===true)?G.diapasonLength:G.stringLength,K=this.calcHelper.tensDiam;if(this.tensionOrDiameter==="tension"){this.tension=K;var H=(this.metricImperial==="imperial")?K*this.kgToLbs:K;this.diameter=Math.sqrt(Math.pow((100000/this.frequency),2)*H*9.81/Math.pow(F,2)/Math.PI/G.density);if(this.metricImperial==="metric"){this.diameter=(Math.round(this.diameter*100)/100).toFixed(2);this.diameterOct=(this.diameter/2).toFixed(2)}else{if(this.metricImperial==="imperial"){this.diameter=(Math.round((this.diameter*this.mmToInch)*1000)/1000).toFixed(3);this.diameterOct=(this.diameter/2).toFixed(3)}}var J="";if(this.calcHelper.showOctave===true&&G.showOctaves===true){J=this.tension+" "+this.unitDensity+" = "+this.diameter+"/"+this.diameterOct+" "+this.unitDiameter}else{J=this.tension+" "+this.unitDensity+" = "+this.diameter+" "+this.unitDiameter}}else{if(this.tensionOrDiameter==="diameter"){this.diameter=K;var I=(this.metricImperial==="imperial")?K*this.mmToInch:K;this.tension=Math.pow((this.frequency*(F*10)*I),2)*(Math.PI*G.density/9810000000000);if(this.metricImperial==="metric"){this.tension=(Math.round((this.tension)*100)/100)}else{if(this.metricImperial==="imperial"){this.tension=(Math.round((this.tension*this.kgToLbs)*1000)/1000);this.diameter=this.diameter.toFixed(3)}}J=this.diameter+" "+this.unitDiameter+" = "+this.tension+" "+this.unitDensity}}$("#calc-results").text(J).addClass("pretty-bg").css({"margin-top":"15px"})};r.addCustomTuningsToPage=function(){var J=r.customTunings.tuningsArray,H='<ul id="customInstrumentList" data-role="none">',G=$('<div class="edit-ct-container" data-role="collapsible-set" />');if(J.length){for(var I=0,F=J.length;I<F;I++){H+='<li><a class="customTuning" href="#" data-id="'+I+'" data-instrument="'+J[I].name+'">'+J[I].name+"</a></li>"}H+="</ul>";return H}};r.listResults=function(){var I,F=r.resultsList.length;if(F){I='<ul id="results-list" data-role="none">';var H=(F===1)?' class="single-list-item"':"";for(var G=0;G<F;G++){I+="<li"+H+'><a href="#" data-id="'+G+'">'+r.resultsList[G].name+": "+r.resultsList[G].stringLength+" "+r.unitLength+", "+r.resultsList[G].pitch+" Hz</a></li>"}I+="</ul>"}else{I="<p>There are currently no saved results</p>"}return I};r.listSingleResults=function(){var F=r.resultsList[this.theseResultsId],J="";for(var H=0,G=r.materials.length;H<G;H++){if(r.materials[H].dataName===F.material){J=r.materials[H].name+", "}}var I='<h3 class="header">'+J+F.stringLength+" "+r.unitLength+", "+F.pitch+' Hz</h3><table id="	"><thead><tr><th scope="col">string</th><th>tension</th><th>diameter</th></tr></thead><tbody>';for(var H=0,G=F.results.length;H<G;H++){console.log(F.results[H]);I+="<tr><td>"+F.results[H].string+"</td><td>"+F.results[H].tension+" "+r.unitDensity+"</td><td>"+F.results[H].diameter+" "+r.unitDiameter+"</td></tr>"}I+="</tbody></table>";return I};$(".iOSlist-container ul a").live("vclick",function(){$(this).addClass("active-link")});$(document).bind("pagehide",function(){$(".iOSlist-container li a").removeClass("active-link")});$("#index").bind("pagecreate",function d(){$(".instrument-type").bind("vclick",function(){r.instrumentType=$(this).attr("data-instrument-type");if($(this).hasClass("quickie")){r.instruments.current=r.instruments.quickie}})});$("#instrument-lists-page").bind("pagebeforeshow",function D(){$("#instrument-list-container").append(r.instruments.lists[r.instrumentType])}).bind("pageinit",function k(){$(".choose-instrument").live("vclick",function(){var J=+$(this).attr("data-id"),H=false;r.instruments.current=r.instruments[r.instrumentType][J];if(r.isLocalStorage===true){localStorage.current=JSON.stringify(r.instruments.current)}for(var I=0,G=r.customDefaults.length;I<G;I++){if(r.customDefaults[I].dataName===r.instruments[r.instrumentType][J].dataName){H=true;var F=I}}if(H===true){r.instruments.current=r.customDefaults[F]}else{if(r.instrumentType==="bowed"){r.instruments.current.material="gut";r.instruments.current.pitch=415;r.instruments.current.density=1300}}})}).bind("pagehide",function C(){$("#instrument-list-container").empty()});$("#saved-results-page").bind("pagebeforeshow",function B(){var F=r.listResults();$("#saved-results-container").append(F).trigger("create")}).bind("pageinit",function e(){$("#results-list li a").live("vclick",function(){r.theseResultsId=+$(this).attr("data-id");$.mobile.changePage($("#individual-results-page"));return false})}).bind("pagehide",function y(){$("#saved-results-container").empty()});$("#individual-results-page").bind("pagebeforeshow",function g(){var F=r.listSingleResults();$("h1.page-header").text(r.resultsList[r.theseResultsId]["name"]);$("#individual-results-container").append(F).trigger("create")}).bind("pageinit",function w(){$("#delete-these-results").bind("vclick",function(){r.resultsList.splice(r.theseResultsId,1);localStorage.resultsList=JSON.stringify(r.resultsList);$.mobile.changePage($("#saved-results-page"),{reverse:true})})}).bind("pagehide",function o(){$("#individual-results-container").empty()});$("#options").bind("pagebeforeshow",function c(){var G=r.options(),I='<a class="button" id="whereTo" href="#calculations-page">Go</a>',H=$('<div id="optionsWrap" />');$("#optionsContent").append(H);$("h1#options-title").text(r.instruments.current.name);if(r.instruments.current.dataName==="quickie"){I='<a class="button" id="whereTo" href="#custom-note">Go</a>';$("#options-page-back-link").attr("href","#index");$("#optionsWrap").prepend(G).append(I).trigger("create")}else{if(r.instruments.current.dataName==="customTuning"){$("#options-page-back-link").attr("href","#custom-tunings-page").trigger("create");I='<fieldset class="ui-grid-a custom-tuning-funk"><div class="ui-block-a"><a id="edit-this-custom-tuning" class="button" href="#">Edit</a></div><div class="ui-block-b"><a href="#calculations-page" class="button">Go</a></div></fieldset>';$("#optionsWrap").prepend(G).append(I).trigger("create")}else{$("#options-page-back-link").attr("href","#instrument-lists-page").trigger("create");var F='<input type="checkbox" name="remember-settings" id="remember-settings" /><label for="remember-settings">Remember these settings</label>';$("#optionsWrap").prepend(G).append(F,I).trigger("create")}}}).bind("pageinit",function h(){$("#edit-this-custom-tuning").live("vclick",function(F){F.preventDefault();r.customTunings.editing=true;$.mobile.changePage($("#create-custom-tuning-page"))});$("#options-page-back-link, #home-link, #whereTo").live("vclick",function(){if($("#remember-settings").attr("checked")=="checked"){r.replaceDefault=r.instruments.current;if(r.customDefaults.length===0){r.customDefaults.push(r.replaceDefault)}else{var H=true;for(var G=0,F=r.customDefaults.length;G<F;G++){if(r.customDefaults[G].dataName===r.replaceDefault.dataName){var I=G;H=false}}if(H===true){r.customDefaults.push(r.replaceDefault)}else{r.customDefaults[I]=r.replaceDefault}if(r.isLocalStorage===true){localStorage.customDefaults=JSON.stringify(r.customDefaults)}else{alert("Seems like storage is not available on your device. I'm afraid I won't be able to save your prefrences.")}}}})}).bind("pagehide",function A(){$(".custom-tuning-funk, #optionsWrap").remove()});$("#pitch").bind("pagebeforeshow",function f(){var J=r.pitches,F=$('<fieldset class="quickChange" data-role="controlgroup" />');for(var I=0,H=J.length;I<H;I++){var G=r.addPitchesToPage(J[I]);F.append(G)}$("#pitch-container").append(F).trigger("create")}).bind("pageinit",function t(){$(".pitch").live("change",function(F){r.instruments.current.pitch=+$(this).val();$("#customPitch").val("");setTimeout(function(){$.mobile.changePage($("#options"),{transition:"flip",reverse:true})},250)});$("#customPitch").bind("change",function(){r.instruments.current.pitch=+$(this).val()})}).bind("pagehide",function m(){$("#pitch-container").empty()});$("#material").bind("pagebeforeshow",function s(){var J=r.materials,G=$('<fieldset class="quickChange" data-role="controlgroup" />');for(var K=0,I=J.length;K<I;K++){var L=J[K].name,H=J[K].density,F=J[K].dataName;materialBlob=r.addMaterialsToPage(L,H,F);G.append(materialBlob)}$("#material-container").append(G).trigger("create")}).bind("pageinit",function E(){$(".density").live("change",function(F){$("#customDensity").val("");r.instruments.current.material=$(this).attr("id");r.instruments.current.density=+$(this).val();setTimeout(function(){$.mobile.changePage($("#options"),{transition:"flip",reverse:true})},250)});$("#customDensity").bind("change",function(){r.instruments.current.material="Custom density";r.instruments.current.density=+$(this).val()})}).bind("pagehide",function v(){$("#material-container").empty()});$("#string-length").bind("pagebeforeshow",function j(){var I=r.instruments.current,F=(localStorage.metricImperial==="metric")?I.stringLength:Math.round((I.stringLength*r.mmToInch)*100)/10,H='<div data-role="fieldcontain" id="string-length-div"><label class="whatUnit" for="string-length-input">Enter a string length in '+r.unitLength+'.*</label><input type="number" id="string-length-input" value="'+F+'" /></div>';$("#string-length-container").prepend(H).trigger("create");if(I.diapasonLength!==undefined){var J=(localStorage.metricImperial==="metric")?+I.diapasonLength:Math.round((+I.diapasonLength*r.mmToInch)*100)/10,G='<div class="archTuning"><label class="whatUnit" for="diapasonLength">Enter a diapason length in '+r.unitLength+'.</label><input type="number" id="diapasonLength" data-key="diapasonLength" value="'+J+'" /></div>';$("#string-length-div").append(G).trigger("create")}}).bind("pageinit",function x(){$("#string-length-input").live("change",function(){r.instruments.current.stringLength=+$(this).val()});if(r.instruments.current.diapasonLength!==undefined){$("#diapasonLength").live("change",function(){r.instruments.current.diapasonLength=+$(this).val()})}}).bind("pagehide",function q(){$("#string-length-container").empty()});$("#number-courses").bind("pagebeforeshow",function u(){var G=r.instruments.current,H=10,F=14;switch(G.dataName){case"baroqueGuitar":H=4,F=6;break;case"renaissanceLute":H=6,F=12;break}$("#num-courses").attr("min",H).attr("max",F).val(G.numberCourses).slider("refresh")}).bind("pageinit",function b(){$("#num-courses").bind("change",function(){r.instruments.current.numberCourses=+$(this).val();if(r.instruments.current.frettedCourses>r.instruments.current.numberCourses){r.instruments.current.frettedCourses=r.instruments.current.numberCourses}})});$("#number-fretted-courses").bind("pagebeforeshow",function(){var G=r.instruments.current,I=+G.frettedCourses,H=6,F=G.tuning.length;if(G.dataName==="renaissanceLute"){F=10}else{if(G.dataName==="theorbo"){F=8}}F=(G.numberCourses<F)?G.numberCourses:F;$("#frettedCourses").val(I).attr("min",H).attr("max",F).slider("refresh")}).bind("pageinit",function(){$("#frettedCourses").live("change",function(){r.instruments.current.frettedCourses=+$(this).val()})});$("#octave-courses").bind("pagebeforeshow",function(){var G=+r.instruments.current.octavesFromCourse,F=r.instruments.current.tuning.length,H=4;switch(r.instruments.current.dataName){case"renaissanceLute":case"archlute":F=7;break;case"theorbo":H=5,F=7;break;case"oud":F=6;break;case"baroqueGuitar":H=3;break}$("#octaveCourses").attr("min",H).attr("max",F).val(G).slider("refresh");if(r.instruments.current.showOctaves===true){$("#no-octaves").attr("checked",false);$("#yes-octaves").attr("checked",true)}else{if(r.instruments.current.showOctaves===false){$("#yes-octaves").attr("checked",false);$("#no-octaves").attr("checked",true);$("#octaveCourses").slider("disable")}}$(".yes-no-octaves").checkboxradio("refresh")}).bind("pageinit",function(){$("#octaveCourses").live("change",function(){r.instruments.current.octavesFromCourse=+$(this).val()});$(".yes-no-octaves").live("change",function(){var F=$(this);if(F.attr("id")==="no-octaves"){$("#octaveCourses").slider("disable")}else{$("#octaveCourses").slider("enable")}if(F.val()==="yes"){r.instruments.current.showOctaves=true}else{if(F.val()==="no"){r.instruments.current.showOctaves=false}}})});$("#diapason-tuning").bind("pagebeforeshow",function(){r.editingThisString="";r.thisStringNoteOctave=[];if(!$("#diapason-tuning-select-note").length){var I=r.createNoteSelectList("diapason-tuning-select-note"),L=r.createOctaveSelectList("diapason-tuning-select-octave");$("#diapason-tuning-note-container").append(I).trigger("create");$("#diapason-tuning-octave-container").append(L).trigger("create");var G=$("#diapason-tuning-select-note");G[0].selectedIndex=9;var M=$("#diapason-tuning-select-octave");M[0].selectedIndex=2;G.add(M).selectmenu("refresh")}$("#diapason-show-hide").hide();var F=$("#diapason-tuning-container"),K='<table id="diapason-tuning-list"><thead><tr><th>Course</th><th>Note</th><th>Action</th></tr></thead><tbody>';thisInstrument=r.instruments.current,arr=(thisInstrument.multipleTunings===true)?thisInstrument.tuning[+thisInstrument.tuningId].tuning:thisInstrument.tuning,diapasonsArray=arr.slice(6,thisInstrument.numberCourses),li="",i=0,l=diapasonsArray.length;for(;i<l;i++){var J=diapasonsArray[i][0],H=diapasonsArray[i][1];K+='<tr data-list-number="'+(i+1)+'" data-note="'+J+'" data-octave="'+H+'"><td class="number">'+(i+7)+'.</td><td class="change-this"><span class="note-name">'+r.whichNote(J)+H+'</span></td><td><a class="editLi" href="#">change</a></td></tr>'}K+="</tbody></table>";F.append(K).trigger("create")}).bind("pageinit",function(){$("#diapason-tuning-list a").live("vclick",function(){if(r.editingThisString!=""&&r.thisStringNoteOctave.length>0){var J=r.thisStringNoteOctave[0],F=r.thisStringNoteOctave[1],I=$("#diapason-tuning-list tr").eq(r.editingThisString-1);I.find("span.note-name").html(r.whichNote(J)+F);$("#diapason-tuning-list").trigger("create")}r.thisStringNoteOctave=[];var K=$(this).closest("tr"),H=+K.attr("data-note"),G=+K.attr("data-octave");r.thisStringNoteOctave.push(H,G);r.editingThisString=+K.attr("data-list-number");$("#diapason-show-hide").show();$(this).parent().html("select a note above")});$("#edit-diapason").live("vclick",function(){var G=+$("#diapason-tuning-select-note").val(),F=+$("#diapason-tuning-select-octave").val(),H=$("#diapason-tuning-list tr").eq(r.editingThisString);tuningArray=(r.instruments.current.multipleTunings===true)?r.instruments.current.tuning[+r.instruments.current.tuningId].tuning:r.instruments.current.tuning,where=r.editingThisString+6,arr=[];arr.push(G,F);tuningArray.splice(where,1,arr);H.find("span.note-name").html(r.whichNote(G)+F).trigger("create");r.editingThisString="";r.thisStringNoteOctave=[]})}).bind("pagehide",function(){$("#diapason-tuning-note-container","#diapason-tuning-octave-container").empty();$("#diapason-tuning-list").remove()});$("#single-diapasons-page").bind("pageinit",function(){$(".single-double-diapasons").live("change",function(){var F=$(this).val();if(F==="single"){r.instruments.current.singleDiapasons=true}else{if(F==="double"){r.instruments.current.singleDiapasons=false}}$.mobile.changePage($("#options"),{transition:"flip",reverse:true})})});$("#dynamic-tuning").bind("pagebeforeshow",function(){var G=r.addTuningsToPage(),F=$('<div data-role="fieldcontain" />');$("#tunings-container").prepend(F);F.append(G).trigger("create")}).bind("pageinit",function(){$(".quickChange input").live("change",function(){r.instruments.current.tuningId=+$(this).attr("id");$.mobile.changePage($("#options"),{transition:"flip",reverse:true})})}).bind("pagehide",function(){$("#fieldContainer").remove()});$("#calculations-page").bind("pagebeforeshow",function a(){$("#tension-diameter-input").val("");var G=r.addCalcsToPage(),F=$('<div id="container" />');r.calcHelper={diapason:false,showOctave:false,disTuningArray:(r.instruments.current.multipleTunings===true)?r.instruments.current.tuning[+r.instruments.current.tuningId].tuning[0]:r.instruments.current.tuning[0],tensDiam:"",currentString:0};r.calcHelper.octaveOffset=r.oct[r.calcHelper.disTuningArray[1]];r.frequency=r.calculateFrequency(r.calcHelper.disTuningArray[0],r.calcHelper.octaveOffset);r.tensionOrDiameter="tension";$("#selectBox").prepend(F);F.append(G).trigger("create");$("#diameter-container").hide();$("h1#instrument-name").text(r.instruments.current.name);$("#tension-diameter-span").text(r.unitDensity);$(".tension-diameter").filter(":first").attr("checked",true).checkboxradio("refresh");$("#radio-choice-2").attr("checked",false).checkboxradio("refresh")}).bind("pageinit",function z(){$("#tension-diameter-input").bind("change",function F(){r.calcHelper.tensDiam=+$(this).val();r.doCalcs()});$("#calc-button").click(function(){r.doCalcs()});$(".tension-diameter").bind("change",function(){r.tensionOrDiameter=$(this).val();$("#tension-diameter-input").val("");if(r.tensionOrDiameter==="diameter"){r.calcHelper.tensDiam=r.diameter;$("#tension-diameter-span").text("mm")}else{if(r.tensionOrDiameter==="tension"){r.calcHelper.tensDiam=r.tension;$("#tension-diameter-span").text("kg")}}});$("#select-string").live("change",function I(){r.calcHelper.currentString=+$(this).val();if(r.instruments.current.frettedCourses===undefined){r.calcHelper.diapason=false}else{if(r.calcHelper.currentString>=+r.instruments.current.frettedCourses){r.calcHelper.diapason=true}else{r.calcHelper.diapason=false}}if(r.instruments.current.octavesFromCourse===undefined){r.calcHelper.showOctave=false}else{if(r.calcHelper.currentString>=(+r.instruments.current.octavesFromCourse-1)){if($.inArray(r.instruments.current.dataName,["theorbo","archlute"])>=0&&r.calcHelper.diapason===true){r.calcHelper.showOctave=(r.instruments.current.singleDiapasons===true)?false:true}else{r.calcHelper.showOctave=true}}else{r.calcHelper.showOctave=false}}r.calcHelper.disTuningArray=(r.instruments.current.multipleTunings===true)?r.instruments.current.tuning[+r.instruments.current.tuningId].tuning[r.calcHelper.currentString]:r.instruments.current.tuning[r.calcHelper.currentString];r.calcHelper.octaveOffset=r.oct[r.calcHelper.disTuningArray[1]];r.frequency=r.calculateFrequency(r.calcHelper.disTuningArray[0],r.calcHelper.octaveOffset);if(r.calcHelper.tensDiam!==""){r.doCalcs()}});$("#save-this-calculation").bind("click",function H(){if($("#tension-diameter-input").val()!=""){var N='<a id="save-results-list" class="button">Save all results</a>',O='<table id="results-table"><thead><tr><th scope="col">string</th><th>tension</th><th>diameter</th><th>action</th></tr></thead><tbody></tbody></table>',M;if(r.instruments.current.multipleTunings===true){M=r.whichNote(r.instruments.current.tuning[+r.instruments.current.tuningId].tuning[r.calcHelper.currentString][0])+r.instruments.current.tuning[+r.instruments.current.tuningId].tuning[r.calcHelper.currentString][1]}else{M=r.whichNote(r.instruments.current.tuning[r.calcHelper.currentString][0])+r.instruments.current.tuning[r.calcHelper.currentString][1]}var K=(r.calcHelper.showOctave===true)?r.diameter+"/"+r.diameterOct:r.diameter;var L='<tr data-string="'+(r.calcHelper.currentString+1)+'" data-tension="'+r.tension+'" data-diameter="'+K+'"><td>'+(r.calcHelper.currentString+1)+"</td><td>"+r.tension+" "+r.unitDensity+"</td>";L+="<td>"+K+" "+r.unitDiameter+"</td>";L+='<td><a href="#" class="delete-results">delete</a></td></tr>';if(!$("#results-table").length){$("#save-calcs-container").append(O)}$("#results-table tbody").append(L).trigger("create");if(!$("#save-results-list").length){$("#save-calcs-container").append(N).trigger("create")}r.showSavedMessage($(this))}});$("a.delete-results").live("click",function G(){$(this).parent().parent().remove();if(!$("#results-table tr").length<=1){$("#save-calcs-container").empty().removeClass("pretty-bg")}});$("#save-results-list").live("click",function J(){var K={name:r.instruments.current.name,material:r.instruments.current.material,stringLength:r.instruments.current.stringLength,pitch:r.instruments.current.pitch,results:[]};$.each($("#results-table tr"),function(L){var N=$(this);if(L>=1){var M={string:+N.attr("data-string"),tension:+N.attr("data-tension"),diameter:N.attr("data-diameter")};K.results.push(M)}});r.resultsList.push(K);if(r.isLocalStorage===true){localStorage.resultsList=JSON.stringify(r.resultsList)}else{alert("Local storage is not available on your device. I'm afraid you won't be able to save your results.")}r.showSavedMessage($(this))})}).bind("pagehide",function n(){r.calcHelper.tensDiam="";$("#container, #container2").remove();$(".diameterResults, .tensionResults, #save-calcs-container").empty().removeClass("pretty-bg");$("#calc-results").empty().removeClass("pretty-bg").css({"margin-top":0})});$("#custom-note").bind("pagebeforecreate",function(){r.calcHelper={diapason:false,showOctave:false,currentString:0};r.tensionOrDiameter="tension"}).bind("pagebeforeshow",function(){}).bind("pageinit",function(){}).bind("pageshow",function(){r.calcHelper.tensDiam="";$(".diameterResults, .tensionResults, #save-calcs-container").empty().removeClass("pretty-bg");$("#calc-results").empty().removeClass("pretty-bg").css({"margin-top":0})})});